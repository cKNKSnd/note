(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{287:function(s,e,t){"use strict";t.r(e);var r=t(13),a=Object(r.a)({},(function(){var s=this,e=s._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h1",{attrs:{id:"使用nginx配置https"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#使用nginx配置https"}},[s._v("#")]),s._v(" 使用Nginx配置HTTPS")]),s._v(" "),e("h2",{attrs:{id:"ssl证书获取"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#ssl证书获取"}},[s._v("#")]),s._v(" SSL证书获取")]),s._v(" "),e("p",[e("a",{attrs:{href:"https://freessl.cn/",target:"_blank",rel:"noopener noreferrer"}},[s._v("FreeSSL.cn"),e("OutboundLink")],1),s._v(" 是一个提供免费HTTPS证书申请的网站。\n可以在该网站申请到3个月时长的免费SSL证书，3个月到期后再续上。")]),s._v(" "),e("ul",[e("li",[s._v("CSR生成选择浏览器生成")])]),s._v(" "),e("p",[s._v("最后会获得一个压缩包，包含两个文件：")]),s._v(" "),e("ul",[e("li",[s._v("full_chain.pem    证书文件")]),s._v(" "),e("li",[s._v("private.key   私钥")])]),s._v(" "),e("p",[s._v("将这两个文件改名，主要是修改文件后缀名，以本网站举例：")]),s._v(" "),e("ul",[e("li",[s._v("full_chain.pem -> dbssx.com.crt")]),s._v(" "),e("li",[s._v("private.key -> dbssx.com.key")])]),s._v(" "),e("h2",{attrs:{id:"nginx配置"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#nginx配置"}},[s._v("#")]),s._v(" Nginx配置")]),s._v(" "),e("p",[s._v("将证书和私钥通过"),e("code",[s._v("scp")]),s._v("到服务器，本站将证书放到"),e("code",[s._v("/home/cjs/ssl_certificate/dbssx.com/")]),s._v("路径下。")]),s._v(" "),e("p",[e("code",[s._v("nginx.conf")]),s._v("配置如下：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("server {\n    listen 80;\n    listen  443 ssl;\n    server_name dbssx.com;\n    ssl_certificate /home/cjs/ssl_certificate/dbssx.com/dbssx.com.crt;\n    ssl_certificate_key /home/cjs/ssl_certificate/dbssx.com/dbssx.com.key;\n    ssl_session_timeout     5m;\n    ssl_protocols   TLSv1 TLSv1.1 TLSv1.2;\n    ssl_ciphers     HIGH:!aNULL:!MD5;\n    ssl_prefer_server_ciphers       on;\n    if ($scheme = http) {\n         return 301 https://$host$request_uri;\n    }\n    location / {\n        proxy_pass http://ip:port;\n        proxy_set_header Host $host:80;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto https;\n    }\n}\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br")])]),e("ul",[e("li",[s._v("ssl_certificate 指定SSL证书")]),s._v(" "),e("li",[s._v("ssl_certificate_key 指定私钥")]),s._v(" "),e("li",[s._v("同时监听80和443端口，如果接收到的请求是http请求，则重定向到https")]),s._v(" "),e("li",[s._v("proxy_pass 代理到真正提供服务的机器所在的ip和端口")]),s._v(" "),e("li",[s._v("server_name 网站的域名")])]),s._v(" "),e("h2",{attrs:{id:"遇到的问题"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#遇到的问题"}},[s._v("#")]),s._v(" 遇到的问题")]),s._v(" "),e("p",[s._v("申请的证书如果不是通配符类型的，如果要使用类似"),e("code",[s._v("api.dbssx.com")]),s._v("的域名，则需要为该域名单独申请SSL证书并配置。")]),s._v(" "),e("h2",{attrs:{id:"使用caddy默认开启https"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#使用caddy默认开启https"}},[s._v("#")]),s._v(" 使用Caddy默认开启HTTPS")]),s._v(" "),e("p",[e("a",{attrs:{href:"https://caddyserver.com",target:"_blank",rel:"noopener noreferrer"}},[s._v("Caddy官网"),e("OutboundLink")],1)]),s._v(" "),e("blockquote",[e("p",[s._v("Caddy 2 is a powerful, enterprise-ready, open source web server with automatic HTTPS written in Go")])])])}),[],!1,null,null,null);e.default=a.exports}}]);